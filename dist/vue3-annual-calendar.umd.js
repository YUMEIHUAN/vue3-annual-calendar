(function(f,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus"],e):(f=typeof globalThis<"u"?globalThis:f||self,e(f.Vue3AnnualCalendar={},f.Vue,f.ElementPlus))})(this,function(f,e,V){"use strict";function F(s=new Date().getFullYear(),h={}){const r=String(s),c=[],u=new Date(r,0,1),m=new Date(r,11,31),d=new Date(u);for(;d<=m;){const n=String(d.getMonth()+1).padStart(2,"0"),p=String(d.getDate()).padStart(2,"0"),w=`${n}-${p}`,b=d.getDay();let D=!1;c.push({date:w,isHoliday:D,weekday:b}),d.setDate(d.getDate()+1)}return{year:r,days:c}}function _(s=new Date){const h=[31,28,31,30,31,30,31,31,30,31,30,31],r=s.getFullYear(),c=s.getMonth(),u=s.getDate();(r%4===0&&r%100!==0||r%400===0)&&(h[1]=29);let d=u;for(let n=0;n<c;n++)d+=h[n];return d}const le="",I=(s,h)=>{const r=s.__vccOpts||s;for(const[c,u]of h)r[c]=u;return r},L={class:"calendar-container"},T={class:"batch-selector"},v={style:{display:"flex","justify-content":"space-between"}},A={class:"weekday-checkboxes"},O={class:"calendar-grid"},$={class:"month-header"},R={class:"calendar"},j={class:"weekdays"},U={class:"days"},W=["onClick"],q={key:0,class:"selected-indicator"},z={class:"dialog-footer"},G="120px",N=I({__name:"AnnualCalendar",props:{year:{type:Number,default:()=>new Date().getFullYear()},initialHolidays:{type:Array,default:()=>[]},showBatchSelector:{type:Boolean,default:!0}},emits:["update:year","holiday-change","year-change"],setup(s,{expose:h,emit:r}){const c=s,u=r,m=e.ref(!1),d=e.ref([]),n=e.ref({year:"",days:[]}),p=e.ref({dateRange:[]}),w=["日","一","二","三","四","五","六"],b=[1,2,3,4,5,6,7,8,9,10,11,12],D=e.ref([{value:"1",label:"周一休息",checked:!1},{value:"2",label:"周二休息",checked:!1},{value:"3",label:"周三休息",checked:!1},{value:"4",label:"周四休息",checked:!1},{value:"5",label:"周五休息",checked:!1},{value:"6",label:"周六休息",checked:!1},{value:"0",label:"周日休息",checked:!1}]),M=e.computed(()=>n.value.days.filter(t=>t.isHoliday).map(t=>t.date)),K=t=>{const a=[],i=new Date(n.value.year,t-1,1),y=new Date(n.value.year,t,0),g=i.getDay(),C=new Date(n.value.year,t-1,0).getDate();for(let l=g-1;l>=0;l--){const o=new Date(n.value.year,t-2,C-l);a.push({day:C-l,date:o,isCurrentMonth:!1})}for(let l=1;l<=y.getDate();l++){const o=new Date(n.value.year,t-1,l);a.push({day:l,date:o,isCurrentMonth:!0,keyId:_(o)-1})}const x=42-a.length;for(let l=1;l<=x;l++){const o=new Date(n.value.year,t,l);a.push({day:l,date:o,isCurrentMonth:!1})}return a},P=t=>{const a=new Date;return t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()},Q=t=>{t.isCurrentMonth&&(n.value.days[t.keyId].isHoliday=!n.value.days[t.keyId].isHoliday,k())},X=(t,a)=>{n.value.days.forEach(i=>{i.weekday==a&&(i.isHoliday=t)}),k()},Z=()=>{m.value=!0},ee=t=>t.getFullYear()!=n.value.year,te=()=>{if(p.value.dateRange.length!==2){V.ElMessage.error("请选择日期范围");return}const[t,a]=p.value.dateRange,i=_(t)-1,y=_(a)-1;for(let g=i;g<=y;g++)n.value.days[g].isHoliday=!0;m.value=!1,k(),V.ElMessage.success("批量设置休息日成功")},k=()=>{u("holiday-change",M.value)},E=t=>{n.value.year=t,n.value=F(t),p.value.dateRange=[new Date(t,0,1),new Date(t,0,1)],d.value=[],u("year-change",t),k(),V.ElMessage.success(`已切换到 ${t} 年`)},B=t=>{n.value.days.forEach(a=>{a.isHoliday=!1}),t.forEach(a=>{const i=new Date(a),y=_(i)-1;n.value.days[y]&&(n.value.days[y].isHoliday=!0)}),k()};return e.watch(()=>c.year,t=>{t!==n.value.year&&(E(t),D.value.forEach(a=>{a.checked=!1}))}),e.watch(()=>c.initialHolidays,t=>{t&&t.length>0&&B(t)},{immediate:!0}),h({loadNewYear:E,setHolidays:B,getSelectedHolidays:()=>M.value,getHolidayData:()=>n.value}),e.onMounted(()=>{E(c.year)}),(t,a)=>{const i=e.resolveComponent("el-checkbox"),y=e.resolveComponent("el-button"),g=e.resolveComponent("el-date-picker"),C=e.resolveComponent("el-form-item"),H=e.resolveComponent("el-form"),x=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("div",T,[a[6]||(a[6]=e.createElementVNode("h3",null,"批量选择休息日",-1)),e.createElementVNode("div",v,[e.createElementVNode("div",A,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.value,l=>(e.openBlock(),e.createBlock(i,{key:l.value,label:l.label,onChange:o=>X(o,l.value),modelValue:l.checked,"onUpdate:modelValue":o=>l.checked=o},null,8,["label","onChange","modelValue","onUpdate:modelValue"]))),128))]),e.createVNode(y,{link:"",type:"primary",onClick:a[0]||(a[0]=l=>Z())},{default:e.withCtx(()=>[...a[5]||(a[5]=[e.createTextVNode(" 批量设置休息日 ",-1)])]),_:1})])]),e.createElementVNode("div",O,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(b,l=>e.createElementVNode("div",{key:l,class:"month-card"},[e.createElementVNode("div",$,e.toDisplayString(n.value.year)+"年 "+e.toDisplayString(l)+"月",1),e.createElementVNode("div",R,[e.createElementVNode("div",j,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(w,o=>e.createElementVNode("div",{key:o},e.toDisplayString(o),1)),64))]),e.createElementVNode("div",U,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(K(l),(o,ae)=>{var S,Y;return e.openBlock(),e.createElementBlock("div",{key:ae,class:e.normalizeClass(["day",{"other-month":!o.isCurrentMonth,selected:(S=n.value.days[o.keyId])==null?void 0:S.isHoliday,today:P(o.date)}]),onClick:oe=>Q(o)},[e.createTextVNode(e.toDisplayString(o.isCurrentMonth?o.day:"")+" ",1),(Y=n.value.days[o.keyId])!=null&&Y.isHoliday?(e.openBlock(),e.createElementBlock("div",q,"休")):e.createCommentVNode("",!0)],10,W)}),128))])])])),64))]),e.createVNode(x,{modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=l=>m.value=l),title:"批量设置休假日期",width:"500"},{footer:e.withCtx(()=>[e.createElementVNode("div",z,[e.createVNode(y,{onClick:a[2]||(a[2]=l=>m.value=!1)},{default:e.withCtx(()=>[...a[7]||(a[7]=[e.createTextVNode("取消",-1)])]),_:1}),e.createVNode(y,{type:"primary",onClick:a[3]||(a[3]=l=>te())},{default:e.withCtx(()=>[...a[8]||(a[8]=[e.createTextVNode("确认",-1)])]),_:1})])]),default:e.withCtx(()=>[e.createVNode(H,{model:p.value},{default:e.withCtx(()=>[e.createVNode(C,{label:"日期范围","label-width":G},{default:e.withCtx(()=>[e.createVNode(g,{modelValue:p.value.dateRange,"onUpdate:modelValue":a[1]||(a[1]=l=>p.value.dateRange=l),type:"daterange","disabled-date":ee,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-f255a51b"]]),J={install(s){s.component("AnnualCalendar",N)}};f.AnnualCalendar=N,f.default=J,Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
