(function(u,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus"],e):(u=typeof globalThis<"u"?globalThis:u||self,e(u.Vue3AnnualCalendar={},u.Vue,u.ElementPlus))})(this,function(u,e,C){"use strict";function F(s=new Date().getFullYear(),g={}){const r=String(s),c=[],p=new Date(r,0,1),m=new Date(r,11,31),d=new Date(p);for(;d<=m;){const o=String(d.getMonth()+1).padStart(2,"0"),f=String(d.getDate()).padStart(2,"0"),w=`${o}-${f}`,V=d.getDay();let b=!1;c.push({date:w,isHoliday:b,weekday:V}),d.setDate(d.getDate()+1)}return{year:r,days:c}}function D(s=new Date){const g=[31,28,31,30,31,30,31,31,30,31,30,31],r=s.getFullYear(),c=s.getMonth(),p=s.getDate();(r%4===0&&r%100!==0||r%400===0)&&(g[1]=29);let d=p;for(let o=0;o<c;o++)d+=g[o];return d}const ne="",I=(s,g)=>{const r=s.__vccOpts||s;for(const[c,p]of g)r[c]=p;return r},L={class:"calendar-container"},T={class:"batch-selector"},A={style:{display:"flex","justify-content":"space-between"}},O={class:"weekday-checkboxes"},$={class:"calendar-grid"},v={class:"month-header"},R={class:"calendar"},j={class:"weekdays"},W={class:"days"},q=["onClick"],U={key:0,class:"selected-indicator"},z={class:"dialog-footer"},G="120px",N=I({__name:"AnnualCalendar",props:{year:{type:Number,default:()=>new Date().getFullYear()},initialHolidays:{type:Array,default:()=>[]},showBatchSelector:{type:Boolean,default:!0}},emits:["update:year","holiday-change","year-change"],setup(s,{expose:g,emit:r}){const c=s,p=r,m=e.ref(!1),d=e.ref([]),o=e.ref({year:"",days:[]}),f=e.ref({dateRange:[]}),w=["日","一","二","三","四","五","六"],V=[1,2,3,4,5,6,7,8,9,10,11,12],b=e.ref([{value:"1",label:"周一休息"},{value:"2",label:"周二休息"},{value:"3",label:"周三休息"},{value:"4",label:"周四休息"},{value:"5",label:"周五休息"},{value:"6",label:"周六休息"},{value:"0",label:"周日休息"}]),M=e.computed(()=>o.value.days.filter(t=>t.isHoliday).map(t=>t.date)),K=t=>{const a=[],i=new Date(o.value.year,t-1,1),y=new Date(o.value.year,t,0),h=i.getDay(),k=new Date(o.value.year,t-1,0).getDate();for(let n=h-1;n>=0;n--){const l=new Date(o.value.year,t-2,k-n);a.push({day:k-n,date:l,isCurrentMonth:!1})}for(let n=1;n<=y.getDate();n++){const l=new Date(o.value.year,t-1,n);a.push({day:n,date:l,isCurrentMonth:!0,keyId:D(l)-1})}const x=42-a.length;for(let n=1;n<=x;n++){const l=new Date(o.value.year,t,n);a.push({day:n,date:l,isCurrentMonth:!1})}return a},P=t=>{const a=new Date;return t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()},Q=t=>{t.isCurrentMonth&&(o.value.days[t.keyId].isHoliday=!o.value.days[t.keyId].isHoliday,_())},X=(t,a)=>{o.value.days.forEach(i=>{i.weekday==a&&(i.isHoliday=t)}),_()},Z=()=>{m.value=!0},ee=t=>t.getFullYear()!=o.value.year,te=()=>{if(f.value.dateRange.length!==2){C.ElMessage.error("请选择日期范围");return}const[t,a]=f.value.dateRange,i=D(t)-1,y=D(a)-1;for(let h=i;h<=y;h++)o.value.days[h].isHoliday=!0;m.value=!1,_(),C.ElMessage.success("批量设置休息日成功")},_=()=>{p("holiday-change",M.value)},E=t=>{o.value.year=t,o.value=F(t),f.value.dateRange=[new Date(t,0,1),new Date(t,0,1)],d.value=[],p("year-change",t),_(),C.ElMessage.success(`已切换到 ${t} 年`)},B=t=>{o.value.days.forEach(a=>{a.isHoliday=!1}),t.forEach(a=>{const i=new Date(a),y=D(i)-1;o.value.days[y]&&(o.value.days[y].isHoliday=!0)}),_()};return e.watch(()=>c.year,t=>{t!==o.value.year&&E(t)}),e.watch(()=>c.initialHolidays,t=>{t&&t.length>0&&B(t)},{immediate:!0}),g({loadNewYear:E,setHolidays:B,getSelectedHolidays:()=>M.value,getHolidayData:()=>o.value}),e.onMounted(()=>{E(c.year)}),(t,a)=>{const i=e.resolveComponent("el-checkbox"),y=e.resolveComponent("el-button"),h=e.resolveComponent("el-date-picker"),k=e.resolveComponent("el-form-item"),H=e.resolveComponent("el-form"),x=e.resolveComponent("el-dialog");return e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("div",T,[a[6]||(a[6]=e.createElementVNode("h3",null,"批量选择休息日",-1)),e.createElementVNode("div",A,[e.createElementVNode("div",O,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.value,n=>(e.openBlock(),e.createBlock(i,{key:n.value,label:n.label,onChange:l=>X(l,n.value)},null,8,["label","onChange"]))),128))]),e.createVNode(y,{link:"",type:"primary",onClick:a[0]||(a[0]=n=>Z())},{default:e.withCtx(()=>[...a[5]||(a[5]=[e.createTextVNode(" 批量设置休息日 ",-1)])]),_:1})])]),e.createElementVNode("div",$,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(V,n=>e.createElementVNode("div",{key:n,class:"month-card"},[e.createElementVNode("div",v,e.toDisplayString(o.value.year)+"年 "+e.toDisplayString(n)+"月",1),e.createElementVNode("div",R,[e.createElementVNode("div",j,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(w,l=>e.createElementVNode("div",{key:l},e.toDisplayString(l),1)),64))]),e.createElementVNode("div",W,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(K(n),(l,ae)=>{var S,Y;return e.openBlock(),e.createElementBlock("div",{key:ae,class:e.normalizeClass(["day",{"other-month":!l.isCurrentMonth,selected:(S=o.value.days[l.keyId])==null?void 0:S.isHoliday,today:P(l.date)}]),onClick:le=>Q(l)},[e.createTextVNode(e.toDisplayString(l.isCurrentMonth?l.day:"")+" ",1),(Y=o.value.days[l.keyId])!=null&&Y.isHoliday?(e.openBlock(),e.createElementBlock("div",U,"休")):e.createCommentVNode("",!0)],10,q)}),128))])])])),64))]),e.createVNode(x,{modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=n=>m.value=n),title:"批量设置休假日期",width:"500"},{footer:e.withCtx(()=>[e.createElementVNode("div",z,[e.createVNode(y,{onClick:a[2]||(a[2]=n=>m.value=!1)},{default:e.withCtx(()=>[...a[7]||(a[7]=[e.createTextVNode("取消",-1)])]),_:1}),e.createVNode(y,{type:"primary",onClick:a[3]||(a[3]=n=>te())},{default:e.withCtx(()=>[...a[8]||(a[8]=[e.createTextVNode("确认",-1)])]),_:1})])]),default:e.withCtx(()=>[e.createVNode(H,{model:f.value},{default:e.withCtx(()=>[e.createVNode(k,{label:"日期范围","label-width":G},{default:e.withCtx(()=>[e.createVNode(h,{modelValue:f.value.dateRange,"onUpdate:modelValue":a[1]||(a[1]=n=>f.value.dateRange=n),type:"daterange","disabled-date":ee,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-cbea903a"]]),J={install(s){s.component("AnnualCalendar",N)}};u.AnnualCalendar=N,u.default=J,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
